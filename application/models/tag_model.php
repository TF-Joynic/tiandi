<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');include_once(APPPATH . 'models/base_model.php');class tag_model extends base_model {	public function __construct() {		parent::__construct();		$this->table_name = 'tag';	}    public function plus($id, $count = 1) {        $query = $this->db->select('count')->where('id', $id)->get($this->table_name)->row_array();        $this->db->where('id', $id)->update($this->table_name, array(            'count' => $query['count'] + $count        ));    }	public function add_tag($name , $type = "1" , $content = ""){		if(!$this->is_exist(array("name" => $name))){			$this->create(array(				"count" => 0,				"name" => $name,				"type" => $type,				"content" => $type,			));		}	}	public function get_tag($start = 0 , $count = 5 , $id = "all"){		$tag_data = $id == "all" ? $this->get() : $this->get(array("name" => $id));		return count($tag_data) <= 0 ? false : $tag_data;	}	public function add_tag_json($json){		$result = array();		$json = substr($json, 0 , strlen($json) - 2) . "]";		$json = json_decode($json);		if(count(@$json[0]) < 1){return -1;}		foreach($json as $tag) {			if(strlen($tag->name) < 3 && strlen($tag->name) > 12){				return -2;			}			if(!$this->is_exist(array("name" => $tag->name))){				$this->create(array(					"count" => "0",					"name" => $tag->name,					"type" => "1",					"content" => "",				));			}		}		return 0;	}	public function minus($id, $count = 1) {		$query = $this->db->select('count')->where('id', $id)->get($this->table_name)->row_array();		$this->db->where('id', $id)->update($this->table_name, array(			'count' => $query['count'] - $count		));	}	public function get_list_by_json($json) {		$result = array();		$json = json_decode(substr($json, 0 , strlen($json) - 2) . "]");		if($json == "") return array();		foreach ($json as $tag) {			$result[] = $this->get(array(				'name' => $tag->name			));		}		return $result;	}}