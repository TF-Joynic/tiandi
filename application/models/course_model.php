<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

include_once(APPPATH . 'models/base_model.php');

class course_model extends base_model {	public function __construct() {		parent::__construct();		$this->load->model('course_step_model');		$this->load->model('course_chapter_model');		$this->load->model('tag_model');		$this->table_name = 'course';	}	public function getList($type, $count = 5) {		$list = parent::getList(array(			'status' => 1,			'type' => $type		));		foreach ($list as $item) {			$item['tags'] = $this->get_tag_by_json($item['tags']);			$item['steps'] = $this->get_step_by_json($item['steps']);			$item['chapters'] = $this->get_chapter_by_json($item['chapters']);		}		return $list;	}	private function get_chapter_by_json($json) {		$result = array();		foreach (json_decode($json) as $chapter) {			$result[] = $this->chapter_model->get(array(				'id' => $chapter			));		}		return $result;	}	private function get_step_by_json($json) {		$result = array();		foreach (json_decode($json) as $step) {			$result[] = $this->step_model->get(array(				'id' => $step			));		}		return $result;	}	private function get_tag_by_json($json) {		$result = array();		foreach (json_decode($json) as $tag) {			$result[] = $this->tag_model->get(array(				'id' => $tag			));		}		return $result;	}}