<?php

class user_model extends CI_Model {	public function __construct(){		parent::__construct();	}	public function login($username, $pwd) {		$user = $this->db->select('id, pwd, salt')->where(array (			'name' => $username,			'status' => 1		))->get('user')->row_array();		if (empty($user) || $user['pwd'] !== md5($pwd . $user['salt'])) return false;		$this->session->set_userdata('uid', $user['id']);		return true;	}	public function logout() {		$this->session->unset_userdata('uid');		return true;	}	public function create($params) {		if (!empty($this->db->where('name', $params['name'])->get('user')->row_array())) return false;		$salt = substr(uniqid(rand()), -10);		$this->db->insert('user', array(			'nickname' => $params['nickname'],			'name' => $params['name'],			'salt' => $salt,			'pwd' => md5($params['pwd'] . $salt)		));	}	public function remove($params) {		$query = $this->db->select('id')->where('name', $params['name'])->get('user')->row_array();		if (empty($query) || $query['id'] === $params['auid']) return false;		$this->db->where('name', $params['name'])->delete('user');	}	public function edit($params) {		$this->db->where('id', $params['uid'])->update('user', array(			'nickname' => $params['nickname']		));	}}