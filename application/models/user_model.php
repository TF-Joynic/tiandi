<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');include_once(APPPATH . 'models/base_model.php');class user_model extends base_model {	public function __construct() {		parent::__construct();		$this->table_name = 'user';	}	public function login($username, $pwd) {		$user = $this->db->select('id, pwd, salt,avatar')->where('name', $username)->get('user')->row_array();		if (empty($user) || $user['pwd'] !== md5($pwd . $user['salt'])) return false;		$this->session->set_userdata('uid', $user['id']);		return true;	}	public function logout() {		$this->session->unset_userdata('uid');		return true;	}	public function check_login() {		$uid = $this->session->userdata('uid');		if (!isset($uid)) return false;		return $this->db->where('id', $uid)->get('user')->row_array();	}	public function create($params) {		if (!empty($this->db->where('name', $params['name'])->get('user')->row_array())) return false;		$salt = substr(uniqid(rand()), -10);		$this->db->insert('user', array(			'nickname' => $params['nickname'],			'name' => $params['name'],			'salt' => $salt,			'pwd' => md5($params['pwd'] . $salt)		));	}	public function remove($params) {		$query = $this->db->select('id')->where('name', $params['name'])->get('user')->row_array();		if (empty($query) || $query['id'] === $params['uid']) return false;		$this->db->where('name', $params['name'])->delete('user');	}}